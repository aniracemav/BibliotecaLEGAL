
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Generador de Contratos</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/docx/8.5.0/docx.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
<h1>Generador de Contratos</h1>
<select id="templateSelect">
<option value="">Selecciona una plantilla</option>
<option value="docx:mx_promesa_cv_001">Promesa de Compraventa (MX)</option>
</select>
<div id="form"></div>
<button onclick="generateDocx()">Descargar .docx</button>
<button onclick="generatePDF()">Descargar PDF</button>
<script>
const templates = {"templates": [{"id": "MX-PROM-CV-001", "name": "Promesa de Compraventa (MX)", "path": "docx:mx_promesa_cv_001", "description": "Contrato Promesa de Compraventa (M\u00e9xico) con ad corpus y pena convencional 10%", "variables": [{"name": "nombre_vendedor", "label": "Nombre del Vendedor", "required": true}, {"name": "nombre_comprador", "label": "Nombre del Comprador", "required": true}, {"name": "domicilio_inmueble", "label": "Domicilio del Inmueble", "required": true}, {"name": "precio_total", "label": "Precio Total", "required": true}, {"name": "fecha_firma", "label": "Fecha de Firma", "required": true}, {"name": "notaria", "label": "Notar\u00eda", "required": false}, {"name": "num_escritura", "label": "N\u00famero de Escritura Previa", "required": false}]}]};
document.getElementById('templateSelect').addEventListener('change', function() {
    const selected = this.value;
    const formDiv = document.getElementById('form');
    formDiv.innerHTML = "";
    const tmpl = templates.templates.find(t => "docx:" + t.id.toLowerCase() === selected.toLowerCase() || t.path === selected);
    if (tmpl) {
        tmpl.variables.forEach(v => {
            const input = document.createElement('input');
            input.placeholder = v.label + (v.required ? " *" : "");
            input.name = v.name;
            formDiv.appendChild(input);
            formDiv.appendChild(document.createElement('br'));
        });
    }
});

function generateDocx(){
    const { Document, Packer, Paragraph, TextRun } = window.docx;
    const doc = new Document({
        sections: [{
            children: [
                new Paragraph({ children: [new TextRun("Contrato Promesa de Compraventa (MX)")] }),
                new Paragraph("Contenido del contrato aquÃ­...")
            ]
        }]
    });
    Packer.toBlob(doc).then(blob => {
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = "mx_promesa_cv_001.docx";
        a.click();
    });
}

function generatePDF(){
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    doc.text("Contrato Promesa de Compraventa (MX)", 10, 10);
    doc.save("mx_promesa_cv_001.pdf");
}
</script>
</body>
</html>
